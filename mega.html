<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Lecteur audio depuis MEGA</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/megajs/0.1.3/mega.min.js"></script>
</head>
<body>
  <h1>Lecteur audio depuis MEGA</h1>
  <button onclick="loginToMega()">Se connecter à MEGA</button>
  <div id="audio-list"></div>

  <script>
    // Fonction pour s'assurer que le SDK de MEGA est bien chargé
    function loadMegaSDK() {
      if (typeof mega !== 'undefined') {
        console.log("MEGA SDK chargé");
      } else {
        console.error("Le SDK de MEGA n'a pas été chargé correctement.");
      }
    }

    // Fonction de connexion
    function loginToMega() {
      if (typeof mega !== 'undefined') {
        // Les informations de connexion (email, mot de passe)
        const email = "mikefri58@gmail.com";
        const password = "Fm01031985@";

        mega.login(email, password, function (result) {
          if (result) {
            console.log("Connexion réussie");
            listAudioFiles();
          } else {
            alert("Échec de la connexion");
          }
        });
      } else {
        alert("Le SDK de MEGA n'a pas pu être chargé.");
      }
    }

    // Fonction pour lister les fichiers audio depuis MEGA
    function listAudioFiles() {
      const audioContainer = document.getElementById("audio-list");
      mega.getFiles(function(files) {
        files.forEach(file => {
          if (file.name.endsWith(".mp3") || file.name.endsWith(".wav") || file.name.endsWith(".ogg")) {
            const audioElement = document.createElement("div");
            audioElement.innerHTML = `
              <h3>${file.name}</h3>
              <audio controls>
                <source src="${file.url}" type="audio/mpeg">
                Votre navigateur ne supporte pas l'audio.
              </audio>
            `;
            audioContainer.appendChild(audioElement);
          }
        });
      });
    }

    // Appeler la fonction pour vérifier si le SDK est chargé
    loadMegaSDK();
  </script>
</body>
</html>
